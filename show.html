<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>
			Sembah Dia! Show
		</title>
		<link href="css/vendor/reveal.min.css" rel="stylesheet">
		<link href="css/vendor/theme/default.css" id="theme" rel="stylesheet">
		<link href="css/show.css" rel="stylesheet">
		<script id="lirik-view-template" type="text/html">
		<section>
			<h3>
				<%= lirik %>
			</h3>
		</section>  
		</script>
	</head>
	<body>
		<div class="reveal" id="uploadBg0">
			<!-- Any section element inside of this container is displayed as a slide -->

			<div class="slides" id="slide-view">
			</div>
		</div>

		<div id="videoRearWrap">
			<video id="videoRear"></video>
		</div>

		<div id="videoFrontWrap">
			<video id="videoFront" loop="" muted=""></video>
		</div>
		<!-- <div id="imageWrap">
		<div id="imageBg2">
		</div>
		<div id="imageBg">
		</div>  
	</div> -->

		<div id="additionalText">
			<div id="dateTime">
				<div id="date">
				</div>

				<div id="time">
				</div>
			</div>

			<div id="place">
				GBI PPL Citylink
			</div>

			<div id="copyright">
				Sembah Dia! (http://salzzz.github.io/sembahDia)
			</div>
		</div>

		<div id="colorOverlay">
		</div>

		<div id="blackSlide">
		</div>
		<script src="js/vendor/jquery.min.js" type="text/javascript"></script> <script src="js/vendor/underscore-min.js" type="text/javascript"></script> <script src="js/vendor/jquery.cycle.all.min.js" type=
"text/javascript"></script> <script src="js/vendor/reveal.min.js"></script> <script>
var frontBgType=0,frontBg=1;
		function startTime() {
			var namaHari=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
			var namaBulan=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
			var today=new Date();
			var h=today.getHours();
			var m=today.getMinutes();
			var s=today.getSeconds();
			m = checkTime(m);
			s = checkTime(s);
			document.getElementById('date').innerHTML = namaHari[today.getDay()]+", <b>"+today.getDate()+"<\/b> "+namaBulan[today.getMonth()]+" "+today.getFullYear();
			document.getElementById('time').innerHTML = "<b>"+h+"<\/b>:<small>"+m+":<small>"+s+"<\/small><\/small>";
			var t = setTimeout(function(){startTime()},500);
		}
		function checkTime(i) {
			if (i<10) {i = "0" + i};  // add zero in front of numbers < 10
			return i;
		}
		// Full list of configuration options available here:
		// https://github.com/hakimel/reveal.js#configuration
		function reloadReveal() {
			Reveal.initialize({
				controls: false,
				progress: false,
				history: false,
				keyboard:true,
				center: true,
				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
			});
		}

		function changeSlide(number) {
			Reveal.slide(number, number, number);
		}
		function changeOverlay(rgbaCol){
			$('#colorOverlay').css('background-color', rgbaCol);
		}
		function changeBg(file,code) {
			var fileURL = URL.createObjectURL(file);
			var doAnimation = function(a, b, cb1, cb2) {
				$(b).hide();
				if (cb1) cb1(a, b);
				$(b).delay(200);
				$(b).fadeIn('slow', function() {
					if (cb2) cb2(a, b);
					$(a).fadeOut('slow');
				}); 
			};
			var swapBg = function(a, b, cb1, cb2) {
				if ($(b).hasClass('active')) {
					$(b).removeClass('active');
					doAnimation(b, a, cb1, cb2);
				} else {
					$(b).addClass('active');
					doAnimation(a, b, cb1, cb2);
				}
			};
			var swapType = function(a, b) {
				console.log(frontBg+"SR"+frontBgType);
				if(frontBg==1){
					$(a).hide().fadeIn('slow');
					$(b).show().fadeOut('slow');
				}
			};
			if (file.type.indexOf('video/') != -1) {
				if (code==1){
					frontBgType=1;
					$('#videoFront').fadeOut('slow',function(){
						$('#videoFront').fadeIn('slow');
						$('#videoFront').attr('src', fileURL).load();
					});
					$("#videoFront").bind('ended', function(){
						$("#videoFront").fadeOut('slow');
					});
				}else if (code==2){
					$('#videoRear').fadeOut('slow',function(){
						$('#videoRear').fadeIn('slow');
						$('#videoRear').attr('src', fileURL).load();
					});
					$("#videoRear").bind('ended', function(){
						$("#videoRear").fadeOut('slow');
					});
				}
			}/* else if (file.type.indexOf('image/') != -1) {
				var cb1 = function(a, b) {
					$(b).html('<img src="'+fileURL+'" />');
				};
				frontBgType=2;
				swapType('#imageWrap', '#videoWrap1');
				swapBg('#imageBg', '#imageBg2', cb1, null);
			}*/
		}

		function clearSlide(status) {
			if (status) {
				$('#colorOverlay').fadeOut('slow');
				$('.slides').fadeOut('slow');
			} else {
				$('#colorOverlay').fadeIn('slow');
				$('.slides').fadeIn('slow');    
			}
		}

		function blankSlide(status) {
			if (status) {
				$('#blackSlide').fadeIn('slow');
			} else {
				$('#blackSlide').fadeOut('slow');
			}
		}

		function showDateTime(status) {
			if (status) {
				$('#additionalText').fadeIn('slow');
			} else {
				$('#additionalText').fadeOut('slow');
			}
		}

		function showVideo(videoWrap,status) {
			if (status) {
				frontBg=1;
				if (frontBgType==1)
					$(videoWrap).fadeIn('slow');
				//else if (frontBgType==2)
					//$('#imageWrap').fadeIn('slow');
			} else {
				frontBg=0;
				$(videoWrap).fadeOut('slow');
				//$('#imageWrap').fadeOut('slow');
			}
		}

		var PresenterApp = {
			lirikData: [],
			init: function(options) {
				this.lirikData = options.lirikData;
				this.$lirikView = $('#slide-view');
				this.show(this.lirikData);
				reloadReveal();
			},
			show: function(lirikData) {
				var template = _.template($('#lirik-view-template').html());
				var ctr = 0;
				this.$lirikView.empty();
				_.each(lirikData, function(baris) {
					this.$lirikView.append(template(baris));
					ctr++;
				}, this);
			},
		}
		$(document).ready(function () {
			startTime();
			PresenterApp.init({lirikData: window.opener.lirikData.toJSON()});
		});
		</script>
	</body>
</html>